<a name="Cutback"></a>
<h1>Cutback</h1>

<p>Cutback is a backup system with the goal of creating smaller, more focused backups by generating
filtered file lists before archiving and keeping records of easily reaquirable files.</p>

<a name="Installation"></a>
<h2>Installation</h2>

<a name="Manual"></a>
<h3>Manual</h3>

<pre><code class="sh">$ make
$ sudo make install

# Or
$ make DESTDIR="/" install
</code></pre>

<a name="Strategy"></a>
<h2>Strategy</h2>

<ol>
<li>Gather all files within search paths</li>
<li>Skip

<ul>
<li>Files matching exclusion patterns</li>
<li>Files matching record patterns</li>
</ul>
</li>
<li>Save to <code>ID.manifest</code></li>
<li>Gather all files within search paths</li>
<li>Only

<ul>
<li>Files matching record patterns</li>
</ul>
</li>
<li>Save to <code>ID.records</code></li>
<li>Archive files within the manifest</li>
<li>Only

<ul>
<li>Files within the manifest</li>
</ul>
</li>
<li>Save to <code>ID.tar[.COMPRESSION-SUFFIX]</code></li>
<li>Gather metadata</li>
<li>Backup

<ul>
<li>Date &amp; time (UTC)</li>
<li>Search paths</li>
<li>Duration</li>
</ul>
</li>
<li>Manifest

<ul>
<li>File count</li>
<li>Total file size</li>
</ul>
</li>
<li>Archive

<ul>
<li>Compression

<ul>
<li>Enabled</li>
<li>Tool (gzip, xz, etc.)</li>
<li>Flags (passed to the tool)</li>
</ul>
</li>
<li>Checksum

<ul>
<li>Tool (sha256sum, sha512sum, etc.)</li>
<li>Value</li>
</ul>
</li>
</ul>
</li>
<li>Save to <code>ID.{yaml,json}</code></li>
</ol>


<a name="Manifest"></a>
<h3>Manifest</h3>

<p>The list of all files within the search paths, sans exclusions.</p>

<p>Used for creating the archive and verification of the archive contents.</p>

<a name="Records"></a>
<h3>Records</h3>

<p>The list of all files within the search paths, filtered by the records list.</p>

<p>Used to keep the archive size (and backup duration) low as files within the records should be
easily reaquirable (from external media, internet, etc.)</p>

<a name="Archive"></a>
<h3>Archive</h3>

<p>The (optionally compressed) archive created from the file list within the manifest.</p>

<a name="Metadata"></a>
<h3>Metadata</h3>

<p>The list of all files in the backup (manifest, records, archive, checksum) as well as information
about each of them:</p>

<ul>
<li>Backup

<ul>
<li>Datetime (UTC)</li>
<li>Paths to backup files (manifest, records, archive)</li>
</ul>
</li>
<li>Manifest

<ul>
<li>Number of files</li>
<li>Total sum of the size of files</li>
</ul>
</li>
<li>Records

<ul>
<li>Number of files</li>
<li>Total sum of the size of files</li>
</ul>
</li>
<li>Archive

<ul>
<li>Compression

<ul>
<li>Enabled</li>
<li>Tool (gz, xz, etc)</li>
<li>Flags</li>
</ul>
</li>
<li>Checksum

<ul>
<li>Method</li>
<li>Value</li>
</ul>
</li>
</ul>
</li>
</ul>


<a name="Usage"></a>
<h2>Usage</h2>

<p>The following will backup all files in the current user&rsquo;s home directory as well as a public
<code>/srv/public</code> directory.</p>

<p>All nodes with the <code>node_modules</code>, <code>.bundle</code>, and <code>.cache</code> name will not be included in the file list
or the archive.</p>

<p>In addition, public <code>Songs</code> and <code>Videos</code> directory at any depth will not be included, but will have
a record kept of alongside the archive.<br/>
This will cut the archive size down significantly, as the songs and videos can easily be reaquired.</p>

<pre><code class="sh">$ cutback --paths '~;/srv/public' --excludes 'node_modules;.bundle;.cache' --records '/srv/public/*/{Songs,Videos}'
</code></pre>

<p>Cutback can also be configured from a <a href="http://yaml.org/">YAML</a> or <a href="http://json.org/">JSON</a> file with the <code>--config</code> option:</p>

<pre><code class="sh">$ cutback --config backup.yaml
</code></pre>

<p><code>backup.yaml</code></p>

<blockquote><p>Note that paths do not have to be surrounded by quotation marks but every now and then YAML doesn&rsquo;t
assume the value is a String.</p></blockquote>

<pre><code class="yaml">paths:             # Paths to search for files
  - "~"
  - "/srv/public"
excludes:          # Paths to exclude from the file list
  - "node_modules"
  - ".bundle"
  - ".cache"
records:           # Paths to keep a record of, also excluded from the file list
  - "/srv/public/*/{Songs,Videos}"
</code></pre>

<a name="Viewing-Progress"></a>
<h3>Viewing Progress</h3>

<p>If <a href="https://ivarch.com/programs/pv.shtml">PV</a> is installed, you can pass the <code>--progress/-P</code> option</p>

<a name="Development"></a>
<h2>Development</h2>

<p>TODO: Write development instructions here</p>

<a name="Contributing"></a>
<h2>Contributing</h2>

<ol>
<li>Fork it (<a href="https://github.com/your-github-user/cutback/fork">https://github.com/your-github-user/cutback/fork</a>)</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create a new Pull Request</li>
</ol>


<a name="License"></a>
<h2>License</h2>

<p>This program is available as open source under the terms of the MIT License <a href="http://opensource.org/licenses/MIT">http://opensource.org/licenses/MIT</a>.</p>
